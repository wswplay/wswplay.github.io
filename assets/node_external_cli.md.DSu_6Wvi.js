import{_ as n,c as a,o as l,b as e}from"./chunks/framework.DUr976bL.js";const E=JSON.parse('{"title":"怎么写一个node命令行工具","description":"","frontmatter":{"title":"怎么写一个node命令行工具","outline":"deep"},"headers":[{"level":2,"title":"创建一个项目及文件","slug":"创建一个项目及文件","link":"#创建一个项目及文件","children":[]},{"level":2,"title":"初级：打印个 Hello 先","slug":"初级-打印个-hello-先","link":"#初级-打印个-hello-先","children":[{"level":3,"title":"index.js","slug":"index-js","link":"#index-js","children":[]},{"level":3,"title":"package.json","slug":"package-json","link":"#package-json","children":[]},{"level":3,"title":"目录结构","slug":"目录结构","link":"#目录结构","children":[]}]},{"level":2,"title":"进阶：整点高级的","slug":"进阶-整点高级的","link":"#进阶-整点高级的","children":[{"level":3,"title":"process.argv","slug":"process-argv","link":"#process-argv","children":[]},{"level":3,"title":"commander 处理参数","slug":"commander-处理参数","link":"#commander-处理参数","children":[]},{"level":3,"title":"inquirer 添加问答","slug":"inquirer-添加问答","link":"#inquirer-添加问答","children":[]},{"level":3,"title":"shelljs 执行脚本","slug":"shelljs-执行脚本","link":"#shelljs-执行脚本","children":[]},{"level":3,"title":"目录结构","slug":"目录结构-1","link":"#目录结构-1","children":[]}]},{"level":2,"title":"PS：命令安装的位置","slug":"ps-命令安装的位置","link":"#ps-命令安装的位置","children":[]}],"relativePath":"node/external/cli.md","filePath":"node/external/cli.md"}'),p={name:"node/external/cli.md"};function o(r,s,c,i,t,d){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="cli-从-0-写一个-node-命令行工具" tabindex="-1">CLI：从 0 写一个 node 命令行工具 <a class="header-anchor" href="#cli-从-0-写一个-node-命令行工具" aria-label="Permalink to &quot;CLI：从 0 写一个 node 命令行工具&quot;">​</a></h1><p>CLI：Command Line Interface。</p><h2 id="创建一个项目及文件" tabindex="-1">创建一个项目及文件 <a class="header-anchor" href="#创建一个项目及文件" aria-label="Permalink to &quot;创建一个项目及文件&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># 创建一个文件夹</span></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#9ECBFF;"> first-node-cli</span></span>
<span class="line"><span style="color:#6A737D;"># 进入文件夹</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#9ECBFF;"> first-node-cli</span></span>
<span class="line"><span style="color:#6A737D;"># 快速创建package.json文件</span></span>
<span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> init</span><span style="color:#79B8FF;"> -y</span></span>
<span class="line"><span style="color:#6A737D;"># 创建index.js文件</span></span>
<span class="line"><span style="color:#B392F0;">touch</span><span style="color:#9ECBFF;"> index.js</span></span>
<span class="line"><span style="color:#6A737D;"># 编辑器打开项目</span></span>
<span class="line"><span style="color:#B392F0;">code</span><span style="color:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="初级-打印个-hello-先" tabindex="-1">初级：打印个 Hello 先 <a class="header-anchor" href="#初级-打印个-hello-先" aria-label="Permalink to &quot;初级：打印个 Hello 先&quot;">​</a></h2><h3 id="index-js" tabindex="-1">index.js <a class="header-anchor" href="#index-js" aria-label="Permalink to &quot;index.js&quot;">​</a></h3><p>在 index.js 文件中，写入以下代码：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// index.js</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Hello, Cli&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>#!/usr/bin/env node</code>：<strong>该行必不可少</strong>。意思是，让系统自动去环境设置寻找 node 目录，再调用对应路径下的解释器程序。实际上，就是告诉这是一个可以用 node <strong>直接执行</strong>的文件。</p><p>所以你可以直接这样运行 index.js</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">./index.js</span></span>
<span class="line"><span style="color:#6A737D;"># zsh: permission denied: ./index.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>于是你会得到<code> zsh: permission denied: ./index.js</code>，没有权限。那就添加权限</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">chmod</span><span style="color:#79B8FF;"> 744</span><span style="color:#9ECBFF;"> index.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>再次运行，你可以看到<code>Hello, Cli</code>了。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">./index.js</span></span>
<span class="line"><span style="color:#6A737D;"># Hello, Cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="package-json" tabindex="-1">package.json <a class="header-anchor" href="#package-json" aria-label="Permalink to &quot;package.json&quot;">​</a></h3><p>在 bin 字段声明一个命令。想多个，就声明多个。</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#79B8FF;">  &quot;bin&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#79B8FF;">    &quot;xiao-cli&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;index.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>运行 <code>xiao-cli</code> 命令</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">xiao-cli</span></span>
<span class="line"><span style="color:#6A737D;"># zsh: command not found: xiao-cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>命令不存在？因为，我们还没有安装嘛，所以终端不认识这个。那就安起</p><blockquote><p>本地测试一个 npm 包，可使用：npm link 本地安装这个包就行。一般是安装到全局。</p></blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm</span><span style="color:#9ECBFF;"> link</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>再次运行命令 <code>xiao-cli</code> 命令，就成功了。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">xiao-cli</span></span>
<span class="line"><span style="color:#6A737D;"># Hello, Cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="目录结构" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构" aria-label="Permalink to &quot;目录结构&quot;">​</a></h3><div class="language-md line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">first-node-cli</span></span>
<span class="line"><span style="color:#E1E4E8;">├── package.json</span></span>
<span class="line"><span style="color:#E1E4E8;">└── index.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="进阶-整点高级的" tabindex="-1">进阶：整点高级的 <a class="header-anchor" href="#进阶-整点高级的" aria-label="Permalink to &quot;进阶：整点高级的&quot;">​</a></h2><h3 id="process-argv" tabindex="-1">process.argv <a class="header-anchor" href="#process-argv" aria-label="Permalink to &quot;process.argv&quot;">​</a></h3><p><code>process.argv</code> 返回一个数组，前两位固定为 <code>node 程序路径</code>和<code>当前运行脚本路径</code>。<br> 从第 3 位开始才是我们输入的内容。</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// index.js</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(process.argv);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>执行：<code>./index.js --template vue</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">./index.js</span><span style="color:#79B8FF;"> --template</span><span style="color:#9ECBFF;"> vue</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">[</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;/Users/youraccount/.nvm/versions/node/v18.14.0/bin/node&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;/Users/youraccount/study/node-lab/first-node-cli/index.js&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;--template&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;vue&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>执行：<code>./index.js --template=vue</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">./index.js</span><span style="color:#79B8FF;"> --template=vue</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">[</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;/Users/youraccount/.nvm/versions/node/v18.14.0/bin/node&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;/Users/youraccount/study/node-lab/first-node-cli/index.js&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#9ECBFF;">  &#39;--template=vue&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="commander-处理参数" tabindex="-1">commander 处理参数 <a class="header-anchor" href="#commander-处理参数" aria-label="Permalink to &quot;commander 处理参数&quot;">​</a></h3><p>当参数很复杂时，需要借助第三方工具处理。【<a href="https://github.com/tj/commander.js" target="_blank" rel="noreferrer">Github 地址</a>】</p><p><strong>在安装前，先调整目录结构：</strong><br> 1、新建 bin 目录专门放置命令文件，将 index.js 移入其中。修改内容为：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// index.js</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">Command</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;commander&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> programer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Command</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">programer.</span><span style="color:#B392F0;">version</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">require</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;../package.json&quot;</span><span style="color:#E1E4E8;">).version);</span></span>
<span class="line"><span style="color:#E1E4E8;">programer.</span><span style="color:#B392F0;">parse</span><span style="color:#E1E4E8;">(process.argv);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2、在 package.json 中添加如下配置：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line highlighted"><span style="color:#79B8FF;">  &quot;bin&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line highlighted"><span style="color:#79B8FF;">    &quot;xiao-cli&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;bin/index.js&quot;</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3、安装 commander</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">pnpm</span><span style="color:#9ECBFF;"> i</span><span style="color:#9ECBFF;"> commander</span><span style="color:#79B8FF;"> -S</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>运行命令看看效果</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">xiao-cli</span><span style="color:#79B8FF;"> -v</span></span>
<span class="line"><span style="color:#6A737D;"># error: unknown option &#39;-v&#39;</span></span>
<span class="line"><span style="color:#6A737D;"># V 要大写才行</span></span>
<span class="line"><span style="color:#B392F0;">xiao-cli</span><span style="color:#79B8FF;"> -V</span></span>
<span class="line"><span style="color:#6A737D;"># 1.0.0</span></span>
<span class="line"><span style="color:#B392F0;">xiao-cli</span><span style="color:#79B8FF;"> -h</span></span>
<span class="line"><span style="color:#6A737D;"># Usage: xiao-cli [options]</span></span>
<span class="line"><span style="color:#6A737D;"># Options:</span></span>
<span class="line"><span style="color:#6A737D;">#   -V, --version  output the version number</span></span>
<span class="line"><span style="color:#6A737D;">#   -h, --help     display help for command</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="inquirer-添加问答" tabindex="-1">inquirer 添加问答 <a class="header-anchor" href="#inquirer-添加问答" aria-label="Permalink to &quot;inquirer 添加问答&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">pnpm</span><span style="color:#9ECBFF;"> i</span><span style="color:#9ECBFF;"> inquirer</span><span style="color:#79B8FF;"> -S</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// bin/index.js</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { Command } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &quot;commander&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> inquirer </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &quot;inquirer&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">// 原生import方式引入json时，需要断言类型才不会报错。</span></span>
<span class="line"><span style="color:#6A737D;">// 断言是一个实验性功能，所以控制台会有提示。</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> pkgInfo </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &quot;../package.json&quot;</span><span style="color:#F97583;"> assert</span><span style="color:#E1E4E8;"> { type: </span><span style="color:#9ECBFF;">&quot;json&quot;</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> programer</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Command</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> initAction</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">  inquirer</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">prompt</span><span style="color:#E1E4E8;">([</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">      {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">        type: </span><span style="color:#9ECBFF;">&quot;input&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">        message: </span><span style="color:#9ECBFF;">&quot;请输入项目名称:&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">        name: </span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">      },</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    ])</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">then</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">answers</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;项目名为：&quot;</span><span style="color:#E1E4E8;">, answers.name);</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;正在拷贝项目，请稍等&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">    });</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">};</span></span>
<span class="line highlighted"><wbr></span>
<span class="line highlighted"><span style="color:#E1E4E8;">programer.</span><span style="color:#B392F0;">command</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;init&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">description</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;创建项目&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">action</span><span style="color:#E1E4E8;">(initAction);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">programer.</span><span style="color:#B392F0;">version</span><span style="color:#E1E4E8;">(pkgInfo.version);</span></span>
<span class="line"><span style="color:#E1E4E8;">programer.</span><span style="color:#B392F0;">parse</span><span style="color:#E1E4E8;">(process.argv);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><code>package.json</code> 添加如下配置，这样才能用 <code>import</code> 关键字导入。</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// package.json</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#79B8FF;">  &quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;module&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>看看效果如何？如下，符合预期。😊</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">xiao-cli</span><span style="color:#9ECBFF;"> init</span></span>
<span class="line"><span style="color:#6A737D;"># ? 请输入项目名称: three-body</span></span>
<span class="line"><span style="color:#6A737D;"># 项目名为： three-body</span></span>
<span class="line"><span style="color:#6A737D;"># 正在拷贝项目，请稍等</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="shelljs-执行脚本" tabindex="-1">shelljs 执行脚本 <a class="header-anchor" href="#shelljs-执行脚本" aria-label="Permalink to &quot;shelljs 执行脚本&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">pnpm</span><span style="color:#9ECBFF;"> i</span><span style="color:#9ECBFF;"> shelljs</span><span style="color:#79B8FF;"> -S</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>bin/index.js</code> 添加高亮部分内容。</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// bin/index.js</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> initAction</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  inquirer</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">prompt</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">then</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">answers</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;项目名为：&quot;</span><span style="color:#E1E4E8;">, answers.name);</span></span>
<span class="line"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;正在拷贝项目，请稍等&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line highlighted"><span style="color:#B392F0;">      cloneViteRepo</span><span style="color:#E1E4E8;">(answers.name);</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#6A737D;">// 克隆Vite项目</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> cloneViteRepo</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">newName</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> remote</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;https://github.com/vitejs/vite&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> curName</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;vite&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  shell.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#9ECBFF;">    \`</span></span>
<span class="line"><span style="color:#9ECBFF;">      git clone \${</span><span style="color:#E1E4E8;">remote</span><span style="color:#9ECBFF;">} --depth=1</span></span>
<span class="line"><span style="color:#9ECBFF;">      mv \${</span><span style="color:#E1E4E8;">curName</span><span style="color:#9ECBFF;">} \${</span><span style="color:#E1E4E8;">newName</span><span style="color:#9ECBFF;">}</span></span>
<span class="line"><span style="color:#9ECBFF;">      rm -rf ./\${</span><span style="color:#E1E4E8;">newName</span><span style="color:#9ECBFF;">}/.git</span></span>
<span class="line"><span style="color:#9ECBFF;">      cd \${</span><span style="color:#E1E4E8;">newName</span><span style="color:#9ECBFF;">}</span></span>
<span class="line"><span style="color:#9ECBFF;">      pnpm i</span></span>
<span class="line"><span style="color:#9ECBFF;">    \`</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#FFAB70;">error</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">stdout</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">stderr</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">      if</span><span style="color:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`exec error: \${</span><span style="color:#E1E4E8;">error</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">        return</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`\${</span><span style="color:#E1E4E8;">stdout</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">      console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`\${</span><span style="color:#E1E4E8;">stderr</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  );</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>大功告成。运行 <code>xiao-cli</code> 就能克隆 Vite 项目啦！💯</p><h3 id="目录结构-1" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构-1" aria-label="Permalink to &quot;目录结构&quot;">​</a></h3><div class="language-md line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">md</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">first-node-cli</span></span>
<span class="line"><span style="color:#E1E4E8;">├── bin</span></span>
<span class="line"><span style="color:#E1E4E8;">│ └── index.js</span></span>
<span class="line"><span style="color:#E1E4E8;">├── package.json</span></span>
<span class="line"><span style="color:#E1E4E8;">└── pnpm-lock.yaml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="ps-命令安装的位置" tabindex="-1">PS：命令安装的位置 <a class="header-anchor" href="#ps-命令安装的位置" aria-label="Permalink to &quot;PS：命令安装的位置&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">where</span><span style="color:#9ECBFF;"> xiao-cli</span></span>
<span class="line"><span style="color:#6A737D;"># /Users/youraccount/.nvm/versions/node/v18.14.0/bin/xiao-cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>`,63)]))}const u=n(p,[["render",o]]);export{E as __pageData,u as default};
